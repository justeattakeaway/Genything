/// A finite sequence of values generated by the provided `generator` closure
///
/// - Warning: The sequence is destructively consumed by iteration.
///     Repeated access will continue at the existing iteration. As a consequence, don't assume
///     that multiple for-in loops will restart from the beginning.
public struct FiniteSequence<Element>: Sequence, IteratorProtocol {
    private let generator: () -> Element
    private let size: Int

    private var index = 0

    init(size: Int, _ generator: @escaping () -> Element) {
        self.size = size
        self.generator = generator
    }

    /// Returns: The next element in this sequence
    mutating public func next() -> Element? {
        guard index < size else { return nil }

        index += 1

        return generator()
    }
}
